[tox]
env_list =
    pytest
    pylint
    eslint
    stylelint
minversion = 4.6.0
skip_missing_interpreters = false

[testenv]
description = base environment
package = wheel
wheel_build_env = .pkg
deps =
    pytest: -r requirements.txt
    eslint,stylelint: nodeenv
commands_pre =
    {es,style}lint: ./ci/node-install.sh
allowlist_externals =
    {es,style}lint: ./ci/node-install.sh

[testenv:pytest]
description = run the tests with pytest
deps =
    {[testenv]deps}
    pytest>=6
    pytest-mock>=3
commands = pytest {tty:--color=yes} {posargs}

[testenv:pylint]
description = run python black linters
skip_install = true
deps =
    black==24.8.0
commands = black --check {posargs: ./tests ./dashboard}

[testenv:eslint]
description = run eslint
skip_install = true
commands = npm run lint:js

[testenv:stylelint]
description = run stylelint
skip_install = true
commands = npm run lint:css
